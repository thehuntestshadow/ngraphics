<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - HEFAISTOS</title>
    <script>if(localStorage.getItem('ngraphics_theme')==='light')document.documentElement.setAttribute('data-theme','light')</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="settings.css">
    <script src="config.js"></script>
    <script src="supabase.js"></script>
    <script src="auth-ui.js"></script>
</head>
<body>
    <!-- Noise overlay -->
    <div class="noise-overlay"></div>

    <!-- Gradient orbs for atmosphere -->
    <div class="ambient-orb orb-1"></div>
    <div class="ambient-orb orb-2"></div>

    <!-- Header -->
    <header class="site-header">
        <div class="header-content">
            <div class="logo-group">
                <a href="index.html" class="logo-link">
                    <span class="logo-title">HEFAISTOS</span>
                </a>
            </div>
            <div class="page-title-center">
                <span class="page-title-text">Settings</span>
            </div>
            <div class="header-controls">
                <a href="dashboard.html" class="dashboard-link" title="Dashboard">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"/>
                        <rect x="14" y="3" width="7" height="7"/>
                        <rect x="14" y="14" width="7" height="7"/>
                        <rect x="3" y="14" width="7" height="7"/>
                    </svg>
                    <span>Dashboard</span>
                </a>
                <div id="accountContainer"></div>
                <button class="theme-toggle" id="themeToggle" title="Toggle light/dark mode">
                    <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    </svg>
                    <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"/>
                        <line x1="12" y1="1" x2="12" y2="3"/>
                        <line x1="12" y1="21" x2="12" y2="23"/>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                        <line x1="1" y1="12" x2="3" y2="12"/>
                        <line x1="21" y1="12" x2="23" y2="12"/>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="settings-page">
        <div class="settings-layout">
            <!-- Sidebar Navigation -->
            <nav class="settings-sidebar">
                <a href="#profile" class="settings-nav-item active" data-section="profile">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                    <span>Profile</span>
                </a>
                <a href="#billing" class="settings-nav-item" data-section="billing">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                        <line x1="1" y1="10" x2="23" y2="10"/>
                    </svg>
                    <span>Usage & Billing</span>
                </a>
                <a href="#api-keys" class="settings-nav-item" data-section="api-keys">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
                    </svg>
                    <span>API Keys</span>
                </a>
                <a href="#appearance" class="settings-nav-item" data-section="appearance">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"/>
                        <line x1="12" y1="1" x2="12" y2="3"/>
                        <line x1="12" y1="21" x2="12" y2="23"/>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                        <line x1="1" y1="12" x2="3" y2="12"/>
                        <line x1="21" y1="12" x2="23" y2="12"/>
                    </svg>
                    <span>Appearance</span>
                </a>
                <a href="#language" class="settings-nav-item" data-section="language">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="2" y1="12" x2="22" y2="12"/>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                    </svg>
                    <span>Language</span>
                </a>
                <a href="#danger" class="settings-nav-item settings-nav-danger" data-section="danger">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                        <line x1="12" y1="9" x2="12" y2="13"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    <span>Danger Zone</span>
                </a>
            </nav>

            <!-- Content Area -->
            <div class="settings-content">
                <!-- Profile Section -->
                <section id="profile" class="settings-section active">
                    <div class="settings-section-header">
                        <h2>Profile</h2>
                        <p>Manage your account information</p>
                    </div>
                    <div class="settings-section-body">
                        <div class="settings-form-group">
                            <label for="displayName">Display Name</label>
                            <input type="text" id="displayName" placeholder="Your name">
                        </div>
                        <div class="settings-form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" disabled class="settings-input-disabled">
                            <span class="settings-hint">Email cannot be changed</span>
                        </div>
                        <div class="settings-actions">
                            <button class="btn-primary" id="saveProfileBtn">Save Profile</button>
                        </div>
                    </div>
                </section>

                <!-- Usage & Billing Section -->
                <section id="billing" class="settings-section">
                    <div class="settings-section-header">
                        <h2>Usage & Billing</h2>
                        <p>Monitor your usage and manage subscription</p>
                    </div>
                    <div class="settings-section-body">
                        <div id="usageContainer" class="settings-usage-container">
                            <div class="usage-loading">Loading usage data...</div>
                        </div>
                    </div>
                </section>

                <!-- API Keys Section -->
                <section id="api-keys" class="settings-section">
                    <div class="settings-section-header">
                        <h2>API Keys</h2>
                        <p>Configure external service integrations</p>
                    </div>
                    <div class="settings-section-body">
                        <div class="settings-form-group">
                            <label for="lumaApiKey">Luma AI API Key</label>
                            <div class="settings-input-with-actions">
                                <input type="password" id="lumaApiKey" placeholder="luma-..." autocomplete="off">
                                <button class="btn-icon" id="toggleLumaKey" title="Show/hide">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                        <circle cx="12" cy="12" r="3"/>
                                    </svg>
                                </button>
                                <button class="btn-icon" id="testLumaKey" title="Test key">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="20 6 9 17 4 12"/>
                                    </svg>
                                </button>
                            </div>
                            <span class="settings-hint">Required for Model Video studio. <a href="https://lumalabs.ai/dream-machine/api" target="_blank" rel="noopener">Get API key</a></span>
                        </div>
                        <div class="settings-actions">
                            <button class="btn-primary" id="saveApiKeysBtn">Save API Key</button>
                        </div>
                    </div>
                </section>

                <!-- Appearance Section -->
                <section id="appearance" class="settings-section">
                    <div class="settings-section-header">
                        <h2>Appearance</h2>
                        <p>Customize the look and feel</p>
                    </div>
                    <div class="settings-section-body">
                        <div class="settings-form-group">
                            <label>Theme</label>
                            <div class="settings-theme-toggle" id="settingsThemeToggle">
                                <button class="theme-btn" data-theme="dark">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                                    </svg>
                                    <span>Dark</span>
                                </button>
                                <button class="theme-btn" data-theme="light">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="5"/>
                                        <line x1="12" y1="1" x2="12" y2="3"/>
                                        <line x1="12" y1="21" x2="12" y2="23"/>
                                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                                        <line x1="1" y1="12" x2="3" y2="12"/>
                                        <line x1="21" y1="12" x2="23" y2="12"/>
                                    </svg>
                                    <span>Light</span>
                                </button>
                                <button class="theme-btn" data-theme="system">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                                        <line x1="8" y1="21" x2="16" y2="21"/>
                                        <line x1="12" y1="17" x2="12" y2="21"/>
                                    </svg>
                                    <span>System</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Language Section -->
                <section id="language" class="settings-section">
                    <div class="settings-section-header">
                        <h2>Language</h2>
                        <p>Set your preferred languages</p>
                    </div>
                    <div class="settings-section-body">
                        <div class="settings-form-group">
                            <label for="interfaceLanguage">Interface Language</label>
                            <select id="interfaceLanguage" class="settings-select">
                                <!-- Populated by JS -->
                            </select>
                            <span class="settings-hint">Controls buttons, labels, and menus</span>
                        </div>
                        <div class="settings-form-group">
                            <label for="generationLanguage">Generation Language</label>
                            <select id="generationLanguage" class="settings-select">
                                <!-- Populated by JS -->
                            </select>
                            <span class="settings-hint">Text in generated images and AI content</span>
                        </div>
                    </div>
                </section>

                <!-- Danger Zone Section -->
                <section id="danger" class="settings-section settings-section-danger">
                    <div class="settings-section-header">
                        <h2>Danger Zone</h2>
                        <p>Irreversible actions - proceed with caution</p>
                    </div>
                    <div class="settings-section-body">
                        <div class="danger-action">
                            <div class="danger-action-info">
                                <h4>Clear All History</h4>
                                <p>Remove all generation history from all studios</p>
                            </div>
                            <button class="btn-danger-outline" id="clearHistoryBtn">Clear History</button>
                        </div>
                        <div class="danger-action">
                            <div class="danger-action-info">
                                <h4>Clear All Favorites</h4>
                                <p>Remove all saved favorites from all studios</p>
                            </div>
                            <button class="btn-danger-outline" id="clearFavoritesBtn">Clear Favorites</button>
                        </div>
                        <div class="danger-action" id="deleteAccountRow">
                            <div class="danger-action-info">
                                <h4>Delete Account</h4>
                                <p>Permanently delete your account and all cloud data</p>
                            </div>
                            <button class="btn-danger" id="deleteAccountBtn">Delete Account</button>
                        </div>
                    </div>
                </section>

                <!-- Not Logged In Message -->
                <section id="notLoggedIn" class="settings-section settings-not-logged-in" style="display: none;">
                    <div class="settings-login-prompt">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                        </svg>
                        <h2>Sign in to access settings</h2>
                        <p>Create a free account to save your preferences and sync across devices</p>
                        <div class="settings-login-buttons">
                            <button class="btn-primary" id="signInBtn">Sign In</button>
                            <button class="btn-secondary" id="createAccountBtn">Create Account</button>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <span>HEFAISTOS</span>
            <span class="footer-divider">&bull;</span>
            <span>Powered by OpenRouter AI</span>
        </div>
    </footer>

    <script src="i18n.js"></script>
    <script src="shared.js"></script>
    <script src="settings.js"></script>
</body>
</html>
